/* esm.sh - esbuild bundle(d3-hierarchy@3.1.2) esnext production */
function Re(e,t){return e.parent===t.parent?1:2}function Se(e){return e.reduce(qe,0)/e.length}function qe(e,t){return e+t.x}function Ne(e){return 1+e.reduce(Ie,0)}function Ie(e,t){return Math.max(e,t.y)}function Ee(e){for(var t;t=e.children;)e=t[0];return e}function Be(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Le(){var e=Re,t=1,r=1,n=!1;function i(u){var o,h=0;u.eachAfter(function(a){var p=a.children;p?(a.x=Se(p),a.y=Ne(p)):(a.x=o?h+=e(a,o):0,a.y=0,o=a)});var l=Ee(u),f=Be(u),c=l.x-e(l,f)/2,s=f.x+e(f,l)/2;return u.eachAfter(n?function(a){a.x=(a.x-u.x)*t,a.y=(u.y-a.y)*r}:function(a){a.x=(a.x-c)/(s-c)*t,a.y=(1-(u.y?a.y/u.y:1))*r})}return i.separation=function(u){return arguments.length?(e=u,i):e},i.size=function(u){return arguments.length?(n=!1,t=+u[0],r=+u[1],i):n?null:[t,r]},i.nodeSize=function(u){return arguments.length?(n=!0,t=+u[0],r=+u[1],i):n?[t,r]:null},i}function Ce(e){var t=0,r=e.children,n=r&&r.length;if(!n)t=1;else for(;--n>=0;)t+=r[n].value;e.value=t}function re(){return this.eachAfter(Ce)}function ne(e,t){let r=-1;for(let n of this)e.call(t,n,++r,this);return this}function ie(e,t){for(var r=this,n=[r],i,u,o=-1;r=n.pop();)if(e.call(t,r,++o,this),i=r.children)for(u=i.length-1;u>=0;--u)n.push(i[u]);return this}function ue(e,t){for(var r=this,n=[r],i=[],u,o,h,l=-1;r=n.pop();)if(i.push(r),u=r.children)for(o=0,h=u.length;o<h;++o)n.push(u[o]);for(;r=i.pop();)e.call(t,r,++l,this);return this}function ae(e,t){let r=-1;for(let n of this)if(e.call(t,n,++r,this))return n}function fe(e){return this.eachAfter(function(t){for(var r=+e(t.data)||0,n=t.children,i=n&&n.length;--i>=0;)r+=n[i].value;t.value=r})}function oe(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function le(e){for(var t=this,r=De(t,e),n=[t];t!==r;)t=t.parent,n.push(t);for(var i=n.length;e!==r;)n.splice(i,0,e),e=e.parent;return n}function De(e,t){if(e===t)return e;var r=e.ancestors(),n=t.ancestors(),i=null;for(e=r.pop(),t=n.pop();e===t;)i=e,e=r.pop(),t=n.pop();return i}function ce(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function he(){return Array.from(this)}function se(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function pe(){var e=this,t=[];return e.each(function(r){r!==e&&t.push({source:r.parent,target:r})}),t}function*de(){var e=this,t,r=[e],n,i,u;do for(t=r.reverse(),r=[];e=t.pop();)if(yield e,n=e.children)for(i=0,u=n.length;i<u;++i)r.push(n[i]);while(r.length)}function T(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Oe)):t===void 0&&(t=be);for(var r=new M(e),n,i=[r],u,o,h,l;n=i.pop();)if((o=t(n.data))&&(l=(o=Array.from(o)).length))for(n.children=o,h=l-1;h>=0;--h)i.push(u=o[h]=new M(o[h])),u.parent=n,u.depth=n.depth+1;return r.eachBefore(Z)}function Te(){return T(this).eachBefore(Ve)}function be(e){return e.children}function Oe(e){return Array.isArray(e)?e[1]:null}function Ve(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Z(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function M(e){this.data=e,this.depth=this.height=0,this.parent=null}M.prototype=T.prototype={constructor:M,count:re,each:ne,eachAfter:ue,eachBefore:ie,find:ae,sum:fe,sort:oe,path:le,ancestors:ce,descendants:he,leaves:se,links:pe,copy:Te,[Symbol.iterator]:de};function L(e){return e==null?null:j(e)}function j(e){if(typeof e!="function")throw new Error;return e}function R(){return 0}function N(e){return function(){return e}}function C(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function me(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xe(e,t){let r=e.length,n,i;for(;r;)i=t()*r--|0,n=e[r],e[r]=e[i],e[i]=n;return e}function We(e){return K(e,C())}function K(e,t){for(var r=0,n=(e=xe(Array.from(e),t)).length,i=[],u,o;r<n;)u=e[r],o&&ge(o,u)?++r:(o=Ze(i=Pe(i,u)),r=0);return o}function Pe(e,t){var r,n;if(H(t,e))return[t];for(r=0;r<e.length;++r)if(b(t,e[r])&&H(D(e[r],t),e))return[e[r],t];for(r=0;r<e.length-1;++r)for(n=r+1;n<e.length;++n)if(b(D(e[r],e[n]),t)&&b(D(e[r],t),e[n])&&b(D(e[n],t),e[r])&&H(ye(e[r],e[n],t),e))return[e[r],e[n],t];throw new Error}function b(e,t){var r=e.r-t.r,n=t.x-e.x,i=t.y-e.y;return r<0||r*r<n*n+i*i}function ge(e,t){var r=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,n=t.x-e.x,i=t.y-e.y;return r>0&&r*r>n*n+i*i}function H(e,t){for(var r=0;r<t.length;++r)if(!ge(e,t[r]))return!1;return!0}function Ze(e){switch(e.length){case 1:return je(e[0]);case 2:return D(e[0],e[1]);case 3:return ye(e[0],e[1],e[2])}}function je(e){return{x:e.x,y:e.y,r:e.r}}function D(e,t){var r=e.x,n=e.y,i=e.r,u=t.x,o=t.y,h=t.r,l=u-r,f=o-n,c=h-i,s=Math.sqrt(l*l+f*f);return{x:(r+u+l/s*c)/2,y:(n+o+f/s*c)/2,r:(s+i+h)/2}}function ye(e,t,r){var n=e.x,i=e.y,u=e.r,o=t.x,h=t.y,l=t.r,f=r.x,c=r.y,s=r.r,a=n-o,p=n-f,d=i-h,m=i-c,x=l-u,g=s-u,y=n*n+i*i-u*u,_=y-o*o-h*h+l*l,w=y-f*f-c*c+s*s,v=p*d-a*m,z=(d*w-m*_)/(v*2)-n,q=(m*x-d*g)/v,A=(p*_-a*w)/(v*2)-i,k=(a*g-p*x)/v,B=q*q+k*k-1,I=2*(u+z*q+A*k),te=z*z+A*A-u*u,P=-(Math.abs(B)>1e-6?(I+Math.sqrt(I*I-4*B*te))/(2*B):te/I);return{x:n+z+q*P,y:i+A+k*P,r:P}}function ve(e,t,r){var n=e.x-t.x,i,u,o=e.y-t.y,h,l,f=n*n+o*o;f?(u=t.r+r.r,u*=u,l=e.r+r.r,l*=l,u>l?(i=(f+l-u)/(2*f),h=Math.sqrt(Math.max(0,l/f-i*i)),r.x=e.x-i*n-h*o,r.y=e.y-i*o+h*n):(i=(f+u-l)/(2*f),h=Math.sqrt(Math.max(0,u/f-i*i)),r.x=t.x+i*n-h*o,r.y=t.y+i*o+h*n)):(r.x=t.x+r.r,r.y=t.y)}function we(e,t){var r=e.r+t.r-1e-6,n=t.x-e.x,i=t.y-e.y;return r>0&&r*r>n*n+i*i}function _e(e){var t=e._,r=e.next._,n=t.r+r.r,i=(t.x*r.r+r.x*t.r)/n,u=(t.y*r.r+r.y*t.r)/n;return i*i+u*u}function O(e){this._=e,this.next=null,this.previous=null}function X(e,t){if(!(u=(e=me(e)).length))return 0;var r,n,i,u,o,h,l,f,c,s,a;if(r=e[0],r.x=0,r.y=0,!(u>1))return r.r;if(n=e[1],r.x=-n.r,n.x=r.r,n.y=0,!(u>2))return r.r+n.r;ve(n,r,i=e[2]),r=new O(r),n=new O(n),i=new O(i),r.next=i.previous=n,n.next=r.previous=i,i.next=n.previous=r;e:for(l=3;l<u;++l){ve(r._,n._,i=e[l]),i=new O(i),f=n.next,c=r.previous,s=n._.r,a=r._.r;do if(s<=a){if(we(f._,i._)){n=f,r.next=n,n.previous=r,--l;continue e}s+=f._.r,f=f.next}else{if(we(c._,i._)){r=c,r.next=n,n.previous=r,--l;continue e}a+=c._.r,c=c.previous}while(f!==c.next);for(i.previous=r,i.next=n,r.next=n.previous=n=i,o=_e(r);(i=i.next)!==n;)(h=_e(i))<o&&(r=i,o=h);n=r.next}for(r=[n._],i=n;(i=i.next)!==n;)r.push(i._);for(i=K(r,t),l=0;l<u;++l)r=e[l],r.x-=i.x,r.y-=i.y;return i.r}function He(e){return X(e,C()),e}function Ke(e){return Math.sqrt(e.value)}function Xe(){var e=null,t=1,r=1,n=R;function i(u){let o=C();return u.x=t/2,u.y=r/2,e?u.eachBefore(ze(e)).eachAfter(Y(n,.5,o)).eachBefore(Ae(1)):u.eachBefore(ze(Ke)).eachAfter(Y(R,1,o)).eachAfter(Y(n,u.r/Math.min(t,r),o)).eachBefore(Ae(Math.min(t,r)/(2*u.r))),u}return i.radius=function(u){return arguments.length?(e=L(u),i):e},i.size=function(u){return arguments.length?(t=+u[0],r=+u[1],i):[t,r]},i.padding=function(u){return arguments.length?(n=typeof u=="function"?u:N(+u),i):n},i}function ze(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Y(e,t,r){return function(n){if(i=n.children){var i,u,o=i.length,h=e(n)*t||0,l;if(h)for(u=0;u<o;++u)i[u].r+=h;if(l=X(i,r),h)for(u=0;u<o;++u)i[u].r-=h;n.r=l+h}}}function Ae(e){return function(t){var r=t.parent;t.r*=e,r&&(t.x=r.x+e*t.x,t.y=r.y+e*t.y)}}function V(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function S(e,t,r,n,i){for(var u=e.children,o,h=-1,l=u.length,f=e.value&&(n-t)/e.value;++h<l;)o=u[h],o.y0=r,o.y1=i,o.x0=t,o.x1=t+=o.value*f}function Ye(){var e=1,t=1,r=0,n=!1;function i(o){var h=o.height+1;return o.x0=o.y0=r,o.x1=e,o.y1=t/h,o.eachBefore(u(t,h)),n&&o.eachBefore(V),o}function u(o,h){return function(l){l.children&&S(l,l.x0,o*(l.depth+1)/h,l.x1,o*(l.depth+2)/h);var f=l.x0,c=l.y0,s=l.x1-r,a=l.y1-r;s<f&&(f=s=(f+s)/2),a<c&&(c=a=(c+a)/2),l.x0=f,l.y0=c,l.x1=s,l.y1=a}}return i.round=function(o){return arguments.length?(n=!!o,i):n},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(r=+o,i):r},i}var $e={depth:-1},ke={},$={};function Fe(e){return e.id}function Ge(e){return e.parentId}function Je(){var e=Fe,t=Ge,r;function n(i){var u=Array.from(i),o=e,h=t,l,f,c,s,a,p,d,m,x=new Map;if(r!=null){let g=u.map((w,v)=>Qe(r(w,v,i))),y=g.map(Me),_=new Set(g).add("");for(let w of y)_.has(w)||(_.add(w),g.push(w),y.push(Me(w)),u.push($));o=(w,v)=>g[v],h=(w,v)=>y[v]}for(c=0,l=u.length;c<l;++c)f=u[c],p=u[c]=new M(f),(d=o(f,c,i))!=null&&(d+="")&&(m=p.id=d,x.set(m,x.has(m)?ke:p)),(d=h(f,c,i))!=null&&(d+="")&&(p.parent=d);for(c=0;c<l;++c)if(p=u[c],d=p.parent){if(a=x.get(d),!a)throw new Error("missing: "+d);if(a===ke)throw new Error("ambiguous: "+d);a.children?a.children.push(p):a.children=[p],p.parent=a}else{if(s)throw new Error("multiple roots");s=p}if(!s)throw new Error("no root");if(r!=null){for(;s.data===$&&s.children.length===1;)s=s.children[0],--l;for(let g=u.length-1;g>=0&&(p=u[g],p.data===$);--g)p.data=null}if(s.parent=$e,s.eachBefore(function(g){g.depth=g.parent.depth+1,--l}).eachBefore(Z),s.parent=null,l>0)throw new Error("cycle");return s}return n.id=function(i){return arguments.length?(e=L(i),n):e},n.parentId=function(i){return arguments.length?(t=L(i),n):t},n.path=function(i){return arguments.length?(r=L(i),n):r},n}function Qe(e){e=`${e}`;let t=e.length;return F(e,t-1)&&!F(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function Me(e){let t=e.length;if(t<2)return"";for(;--t>1&&!F(e,t););return e.slice(0,t)}function F(e,t){if(e[t]==="/"){let r=0;for(;t>0&&e[--t]==="\\";)++r;if(!(r&1))return!0}return!1}function Ue(e,t){return e.parent===t.parent?1:2}function G(e){var t=e.children;return t?t[0]:e.t}function J(e){var t=e.children;return t?t[t.length-1]:e.t}function et(e,t,r){var n=r/(t.i-e.i);t.c-=n,t.s+=r,e.c+=n,t.z+=r,t.m+=r}function tt(e){for(var t=0,r=0,n=e.children,i=n.length,u;--i>=0;)u=n[i],u.z+=t,u.m+=t,t+=u.s+(r+=u.c)}function rt(e,t,r){return e.a.parent===t.parent?e.a:r}function W(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}W.prototype=Object.create(M.prototype);function nt(e){for(var t=new W(e,0),r,n=[t],i,u,o,h;r=n.pop();)if(u=r._.children)for(r.children=new Array(h=u.length),o=h-1;o>=0;--o)n.push(i=r.children[o]=new W(u[o],o)),i.parent=r;return(t.parent=new W(null,0)).children=[t],t}function it(){var e=Ue,t=1,r=1,n=null;function i(f){var c=nt(f);if(c.eachAfter(u),c.parent.m=-c.z,c.eachBefore(o),n)f.eachBefore(l);else{var s=f,a=f,p=f;f.eachBefore(function(y){y.x<s.x&&(s=y),y.x>a.x&&(a=y),y.depth>p.depth&&(p=y)});var d=s===a?1:e(s,a)/2,m=d-s.x,x=t/(a.x+d+m),g=r/(p.depth||1);f.eachBefore(function(y){y.x=(y.x+m)*x,y.y=y.depth*g})}return f}function u(f){var c=f.children,s=f.parent.children,a=f.i?s[f.i-1]:null;if(c){tt(f);var p=(c[0].z+c[c.length-1].z)/2;a?(f.z=a.z+e(f._,a._),f.m=f.z-p):f.z=p}else a&&(f.z=a.z+e(f._,a._));f.parent.A=h(f,a,f.parent.A||s[0])}function o(f){f._.x=f.z+f.parent.m,f.m+=f.parent.m}function h(f,c,s){if(c){for(var a=f,p=f,d=c,m=a.parent.children[0],x=a.m,g=p.m,y=d.m,_=m.m,w;d=J(d),a=G(a),d&&a;)m=G(m),p=J(p),p.a=f,w=d.z+y-a.z-x+e(d._,a._),w>0&&(et(rt(d,f,s),f,w),x+=w,g+=w),y+=d.m,x+=a.m,_+=m.m,g+=p.m;d&&!J(p)&&(p.t=d,p.m+=y-g),a&&!G(m)&&(m.t=a,m.m+=x-_,s=f)}return s}function l(f){f.x*=t,f.y=f.depth*r}return i.separation=function(f){return arguments.length?(e=f,i):e},i.size=function(f){return arguments.length?(n=!1,t=+f[0],r=+f[1],i):n?null:[t,r]},i.nodeSize=function(f){return arguments.length?(n=!0,t=+f[0],r=+f[1],i):n?[t,r]:null},i}function E(e,t,r,n,i){for(var u=e.children,o,h=-1,l=u.length,f=e.value&&(i-r)/e.value;++h<l;)o=u[h],o.x0=t,o.x1=n,o.y0=r,o.y1=r+=o.value*f}var Q=(1+Math.sqrt(5))/2;function U(e,t,r,n,i,u){for(var o=[],h=t.children,l,f,c=0,s=0,a=h.length,p,d,m=t.value,x,g,y,_,w,v,z;c<a;){p=i-r,d=u-n;do x=h[s++].value;while(!x&&s<a);for(g=y=x,v=Math.max(d/p,p/d)/(m*e),z=x*x*v,w=Math.max(y/z,z/g);s<a;++s){if(x+=f=h[s].value,f<g&&(g=f),f>y&&(y=f),z=x*x*v,_=Math.max(y/z,z/g),_>w){x-=f;break}w=_}o.push(l={value:x,dice:p<d,children:h.slice(c,s)}),l.dice?S(l,r,n,i,m?n+=d*x/m:u):E(l,r,n,m?r+=p*x/m:i,u),m-=x,c=s}return o}var ee=function e(t){function r(n,i,u,o,h){U(t,n,i,u,o,h)}return r.ratio=function(n){return e((n=+n)>1?n:1)},r}(Q);function ut(){var e=ee,t=!1,r=1,n=1,i=[0],u=R,o=R,h=R,l=R,f=R;function c(a){return a.x0=a.y0=0,a.x1=r,a.y1=n,a.eachBefore(s),i=[0],t&&a.eachBefore(V),a}function s(a){var p=i[a.depth],d=a.x0+p,m=a.y0+p,x=a.x1-p,g=a.y1-p;x<d&&(d=x=(d+x)/2),g<m&&(m=g=(m+g)/2),a.x0=d,a.y0=m,a.x1=x,a.y1=g,a.children&&(p=i[a.depth+1]=u(a)/2,d+=f(a)-p,m+=o(a)-p,x-=h(a)-p,g-=l(a)-p,x<d&&(d=x=(d+x)/2),g<m&&(m=g=(m+g)/2),e(a,d,m,x,g))}return c.round=function(a){return arguments.length?(t=!!a,c):t},c.size=function(a){return arguments.length?(r=+a[0],n=+a[1],c):[r,n]},c.tile=function(a){return arguments.length?(e=j(a),c):e},c.padding=function(a){return arguments.length?c.paddingInner(a).paddingOuter(a):c.paddingInner()},c.paddingInner=function(a){return arguments.length?(u=typeof a=="function"?a:N(+a),c):u},c.paddingOuter=function(a){return arguments.length?c.paddingTop(a).paddingRight(a).paddingBottom(a).paddingLeft(a):c.paddingTop()},c.paddingTop=function(a){return arguments.length?(o=typeof a=="function"?a:N(+a),c):o},c.paddingRight=function(a){return arguments.length?(h=typeof a=="function"?a:N(+a),c):h},c.paddingBottom=function(a){return arguments.length?(l=typeof a=="function"?a:N(+a),c):l},c.paddingLeft=function(a){return arguments.length?(f=typeof a=="function"?a:N(+a),c):f},c}function at(e,t,r,n,i){var u=e.children,o,h=u.length,l,f=new Array(h+1);for(f[0]=l=o=0;o<h;++o)f[o+1]=l+=u[o].value;c(0,h,e.value,t,r,n,i);function c(s,a,p,d,m,x,g){if(s>=a-1){var y=u[s];y.x0=d,y.y0=m,y.x1=x,y.y1=g;return}for(var _=f[s],w=p/2+_,v=s+1,z=a-1;v<z;){var q=v+z>>>1;f[q]<w?v=q+1:z=q}w-f[v-1]<f[v]-w&&s+1<v&&--v;var A=f[v]-_,k=p-A;if(x-d>g-m){var B=p?(d*k+x*A)/p:x;c(s,v,A,d,m,B,g),c(v,a,k,B,m,x,g)}else{var I=p?(m*k+g*A)/p:g;c(s,v,A,d,m,x,I),c(v,a,k,d,I,x,g)}}}function ft(e,t,r,n,i){(e.depth&1?E:S)(e,t,r,n,i)}var ot=function e(t){function r(n,i,u,o,h){if((l=n._squarify)&&l.ratio===t)for(var l,f,c,s,a=-1,p,d=l.length,m=n.value;++a<d;){for(f=l[a],c=f.children,s=f.value=0,p=c.length;s<p;++s)f.value+=c[s].value;f.dice?S(f,i,u,o,m?u+=(h-u)*f.value/m:h):E(f,i,u,m?i+=(o-i)*f.value/m:o,h),m-=f.value}else n._squarify=l=U(t,n,i,u,o,h),l.ratio=t}return r.ratio=function(n){return e((n=+n)>1?n:1)},r}(Q);export{M as Node,Le as cluster,T as hierarchy,Xe as pack,We as packEnclose,He as packSiblings,Ye as partition,Je as stratify,it as tree,ut as treemap,at as treemapBinary,S as treemapDice,ot as treemapResquarify,E as treemapSlice,ft as treemapSliceDice,ee as treemapSquarify};
//# sourceMappingURL=d3-hierarchy.mjs.map