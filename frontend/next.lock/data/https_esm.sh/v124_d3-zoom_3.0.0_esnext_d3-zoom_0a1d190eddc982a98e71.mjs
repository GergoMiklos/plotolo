/* esm.sh - esbuild bundle(d3-zoom@3.0.0) esnext production */
import{dispatch as ot}from"/v124/d3-dispatch@3.0.1/esnext/d3-dispatch.mjs";import{dragDisable as it,dragEnable as ut}from"/v124/d3-drag@3.0.0/esnext/d3-drag.mjs";import{interpolateZoom as rt}from"/v124/d3-interpolate@3.0.1/esnext/d3-interpolate.mjs";import{select as B,pointer as T}from"/v124/d3-selection@3.0.0/esnext/d3-selection.mjs";import{interrupt as H}from"/v124/d3-transition@3.0.1/esnext/d3-transition.mjs";var X=n=>()=>n;function C(n,{sourceEvent:f,target:m,transform:w,dispatch:_}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:f,enumerable:!0,configurable:!0},target:{value:m,enumerable:!0,configurable:!0},transform:{value:w,enumerable:!0,configurable:!0},_:{value:_}})}function v(n,f,m){this.k=n,this.x=f,this.y=m}v.prototype={constructor:v,scale:function(n){return n===1?this:new v(this.k*n,this.x,this.y)},translate:function(n,f){return n===0&f===0?this:new v(this.k,this.x+this.k*n,this.y+this.k*f)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var V=new v(1,0,0);F.prototype=v.prototype;function F(n){for(;!n.__zoom;)if(!(n=n.parentNode))return V;return n.__zoom}function G(n){n.stopImmediatePropagation()}function E(n){n.preventDefault(),n.stopImmediatePropagation()}function st(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function at(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function L(){return this.__zoom||V}function ht(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function ct(){return navigator.maxTouchPoints||"ontouchstart"in this}function ft(n,f,m){var w=n.invertX(f[0][0])-m[0][0],_=n.invertX(f[1][0])-m[1][0],g=n.invertY(f[0][1])-m[0][1],l=n.invertY(f[1][1])-m[1][1];return n.translate(_>w?(w+_)/2:Math.min(0,w)||Math.max(0,_),l>g?(g+l)/2:Math.min(0,g)||Math.max(0,l))}function lt(){var n=st,f=at,m=ft,w=ht,_=ct,g=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],P=250,K=rt,D=ot("start","zoom","end"),M,S,Y,N=500,Q=150,q=0,W=10;function r(t){t.property("__zoom",L).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",U).on("dblclick.zoom",$).filter(_).on("touchstart.zoom",tt).on("touchmove.zoom",et).on("touchend.zoom touchcancel.zoom",nt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}r.transform=function(t,o,e,i){var u=t.selection?t.selection():t;u.property("__zoom",L),t!==u?O(t,o,e,i):u.interrupt().each(function(){x(this,arguments).event(i).start().zoom(null,typeof o=="function"?o.apply(this,arguments):o).end()})},r.scaleBy=function(t,o,e,i){r.scaleTo(t,function(){var u=this.__zoom.k,s=typeof o=="function"?o.apply(this,arguments):o;return u*s},e,i)},r.scaleTo=function(t,o,e,i){r.transform(t,function(){var u=f.apply(this,arguments),s=this.__zoom,a=e==null?j(u):typeof e=="function"?e.apply(this,arguments):e,h=s.invert(a),c=typeof o=="function"?o.apply(this,arguments):o;return m(I(Z(s,c),a,h),u,l)},e,i)},r.translateBy=function(t,o,e,i){r.transform(t,function(){return m(this.__zoom.translate(typeof o=="function"?o.apply(this,arguments):o,typeof e=="function"?e.apply(this,arguments):e),f.apply(this,arguments),l)},null,i)},r.translateTo=function(t,o,e,i,u){r.transform(t,function(){var s=f.apply(this,arguments),a=this.__zoom,h=i==null?j(s):typeof i=="function"?i.apply(this,arguments):i;return m(V.translate(h[0],h[1]).scale(a.k).translate(typeof o=="function"?-o.apply(this,arguments):-o,typeof e=="function"?-e.apply(this,arguments):-e),s,l)},i,u)};function Z(t,o){return o=Math.max(g[0],Math.min(g[1],o)),o===t.k?t:new v(o,t.x,t.y)}function I(t,o,e){var i=o[0]-e[0]*t.k,u=o[1]-e[1]*t.k;return i===t.x&&u===t.y?t:new v(t.k,i,u)}function j(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function O(t,o,e,i){t.on("start.zoom",function(){x(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(i).end()}).tween("zoom",function(){var u=this,s=arguments,a=x(u,s).event(i),h=f.apply(u,s),c=e==null?j(h):typeof e=="function"?e.apply(u,s):e,z=Math.max(h[1][0]-h[0][0],h[1][1]-h[0][1]),p=u.__zoom,d=typeof o=="function"?o.apply(u,s):o,b=K(p.invert(c).concat(z/p.k),d.invert(c).concat(z/d.k));return function(y){if(y===1)y=d;else{var k=b(y),A=z/k[2];y=new v(A,c[0]-k[0]*A,c[1]-k[1]*A)}a.zoom(null,y)}})}function x(t,o,e){return!e&&t.__zooming||new J(t,o)}function J(t,o){this.that=t,this.args=o,this.active=0,this.sourceEvent=null,this.extent=f.apply(t,o),this.taps=0}J.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,o){return this.mouse&&t!=="mouse"&&(this.mouse[1]=o.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=o.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=o.invert(this.touch1[0])),this.that.__zoom=o,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var o=B(this.that).datum();D.call(t,this.that,new C(t,{sourceEvent:this.sourceEvent,target:r,type:t,transform:this.that.__zoom,dispatch:D}),o)}};function R(t,...o){if(!n.apply(this,arguments))return;var e=x(this,o).event(t),i=this.__zoom,u=Math.max(g[0],Math.min(g[1],i.k*Math.pow(2,w.apply(this,arguments)))),s=T(t);if(e.wheel)(e.mouse[0][0]!==s[0]||e.mouse[0][1]!==s[1])&&(e.mouse[1]=i.invert(e.mouse[0]=s)),clearTimeout(e.wheel);else{if(i.k===u)return;e.mouse=[s,i.invert(s)],H(this),e.start()}E(t),e.wheel=setTimeout(a,Q),e.zoom("mouse",m(I(Z(i,u),e.mouse[0],e.mouse[1]),e.extent,l));function a(){e.wheel=null,e.end()}}function U(t,...o){if(Y||!n.apply(this,arguments))return;var e=t.currentTarget,i=x(this,o,!0).event(t),u=B(t.view).on("mousemove.zoom",c,!0).on("mouseup.zoom",z,!0),s=T(t,e),a=t.clientX,h=t.clientY;it(t.view),G(t),i.mouse=[s,this.__zoom.invert(s)],H(this),i.start();function c(p){if(E(p),!i.moved){var d=p.clientX-a,b=p.clientY-h;i.moved=d*d+b*b>q}i.event(p).zoom("mouse",m(I(i.that.__zoom,i.mouse[0]=T(p,e),i.mouse[1]),i.extent,l))}function z(p){u.on("mousemove.zoom mouseup.zoom",null),ut(p.view,i.moved),E(p),i.event(p).end()}}function $(t,...o){if(n.apply(this,arguments)){var e=this.__zoom,i=T(t.changedTouches?t.changedTouches[0]:t,this),u=e.invert(i),s=e.k*(t.shiftKey?.5:2),a=m(I(Z(e,s),i,u),f.apply(this,o),l);E(t),P>0?B(this).transition().duration(P).call(O,a,i,t):B(this).call(r.transform,a,i,t)}}function tt(t,...o){if(n.apply(this,arguments)){var e=t.touches,i=e.length,u=x(this,o,t.changedTouches.length===i).event(t),s,a,h,c;for(G(t),a=0;a<i;++a)h=e[a],c=T(h,this),c=[c,this.__zoom.invert(c),h.identifier],u.touch0?!u.touch1&&u.touch0[2]!==c[2]&&(u.touch1=c,u.taps=0):(u.touch0=c,s=!0,u.taps=1+!!M);M&&(M=clearTimeout(M)),s&&(u.taps<2&&(S=c[0],M=setTimeout(function(){M=null},N)),H(this),u.start())}}function et(t,...o){if(this.__zooming){var e=x(this,o).event(t),i=t.changedTouches,u=i.length,s,a,h,c;for(E(t),s=0;s<u;++s)a=i[s],h=T(a,this),e.touch0&&e.touch0[2]===a.identifier?e.touch0[0]=h:e.touch1&&e.touch1[2]===a.identifier&&(e.touch1[0]=h);if(a=e.that.__zoom,e.touch1){var z=e.touch0[0],p=e.touch0[1],d=e.touch1[0],b=e.touch1[1],y=(y=d[0]-z[0])*y+(y=d[1]-z[1])*y,k=(k=b[0]-p[0])*k+(k=b[1]-p[1])*k;a=Z(a,Math.sqrt(y/k)),h=[(z[0]+d[0])/2,(z[1]+d[1])/2],c=[(p[0]+b[0])/2,(p[1]+b[1])/2]}else if(e.touch0)h=e.touch0[0],c=e.touch0[1];else return;e.zoom("touch",m(I(a,h,c),e.extent,l))}}function nt(t,...o){if(this.__zooming){var e=x(this,o).event(t),i=t.changedTouches,u=i.length,s,a;for(G(t),Y&&clearTimeout(Y),Y=setTimeout(function(){Y=null},N),s=0;s<u;++s)a=i[s],e.touch0&&e.touch0[2]===a.identifier?delete e.touch0:e.touch1&&e.touch1[2]===a.identifier&&delete e.touch1;if(e.touch1&&!e.touch0&&(e.touch0=e.touch1,delete e.touch1),e.touch0)e.touch0[1]=this.__zoom.invert(e.touch0[0]);else if(e.end(),e.taps===2&&(a=T(a,this),Math.hypot(S[0]-a[0],S[1]-a[1])<W)){var h=B(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return r.wheelDelta=function(t){return arguments.length?(w=typeof t=="function"?t:X(+t),r):w},r.filter=function(t){return arguments.length?(n=typeof t=="function"?t:X(!!t),r):n},r.touchable=function(t){return arguments.length?(_=typeof t=="function"?t:X(!!t),r):_},r.extent=function(t){return arguments.length?(f=typeof t=="function"?t:X([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),r):f},r.scaleExtent=function(t){return arguments.length?(g[0]=+t[0],g[1]=+t[1],r):[g[0],g[1]]},r.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],r):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},r.constrain=function(t){return arguments.length?(m=t,r):m},r.duration=function(t){return arguments.length?(P=+t,r):P},r.interpolate=function(t){return arguments.length?(K=t,r):K},r.on=function(){var t=D.on.apply(D,arguments);return t===D?r:t},r.clickDistance=function(t){return arguments.length?(q=(t=+t)*t,r):Math.sqrt(q)},r.tapDistance=function(t){return arguments.length?(W=+t,r):W},r}export{v as ZoomTransform,lt as zoom,V as zoomIdentity,F as zoomTransform};
//# sourceMappingURL=d3-zoom.mjs.map